<!-- ResuMate Unified Navigation Bar -->
<!-- Include this component in all pages -->

<!-- Live region for screen reader announcements -->
<div id="nav-announcements" class="sr-only" aria-live="polite" aria-atomic="true"></div>

<nav class="resumate-navbar" role="navigation" aria-label="Main navigation">
  <!-- Skip to main content (accessibility) -->
  <a href="#main-content" class="skip-to-main">Skip to main content</a>

  <div class="navbar-container">
    <!-- Brand -->
    <a href="/index.html" class="navbar-brand">
      <span class="navbar-logo" aria-hidden="true">ğŸ¯</span>
      <span class="navbar-title">ResuMate</span>
    </a>

    <!-- Mobile Toggle -->
    <button class="navbar-toggle" type="button" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="navbar-menu">
      <span aria-hidden="true">â˜°</span>
    </button>

    <!-- Navigation Links -->
    <ul class="navbar-nav" id="navbar-menu" role="menubar">
      <!-- Mobile Close Button -->
      <li class="nav-mobile-close" role="none">
        <button class="nav-close-btn" type="button" aria-label="Close navigation menu">
          <span aria-hidden="true">âœ•</span>
        </button>
      </li>

      <!-- Home -->
      <li class="nav-item" role="none">
        <a href="/index.html" class="nav-link" role="menuitem">
          <span class="nav-link-icon" aria-hidden="true">ğŸ </span>
          <span>Home</span>
        </a>
      </li>

      <!-- Workflow -->
      <li class="nav-item" role="none">
        <a href="/workflow.html" class="nav-link" role="menuitem">
          <span class="nav-link-icon" aria-hidden="true">âœ¨</span>
          <span>Resume Workflow</span>
        </a>
      </li>

      <!-- Visual Builder -->
      <li class="nav-item" role="none">
        <a href="/builder.html" class="nav-link" role="menuitem">
          <span class="nav-link-icon" aria-hidden="true">âœï¸</span>
          <span>Builder</span>
        </a>
      </li>

      <!-- Analytics -->
      <li class="nav-item" role="none">
        <a href="/analytics-dashboard.html" class="nav-link" role="menuitem">
          <span class="nav-link-icon" aria-hidden="true">ğŸ“Š</span>
          <span>Analytics</span>
        </a>
      </li>
    </ul>

    <!-- Quick Actions -->
    <div class="navbar-actions">
      <!-- Theme Toggle -->
      <button class="nav-theme-toggle" type="button" onclick="toggleTheme()" aria-label="Toggle dark/light mode" title="Toggle dark/light mode">
        <span class="theme-icon-moon">ğŸŒ™</span>
        <span class="theme-icon-sun">â˜€ï¸</span>
      </button>

      <button class="nav-action-btn" type="button" onclick="window.location.href='/workflow.html'" aria-label="Start resume workflow">
        <span aria-hidden="true">+</span>
        Start Workflow
      </button>
    </div>
  </div>
</nav>

<!-- Mobile Menu Overlay -->
<div class="navbar-overlay" aria-hidden="true"></div>

<!-- Breadcrumbs (optional - add to pages that need context) -->
<!--
<nav class="breadcrumbs" aria-label="Breadcrumb navigation">
  <ol class="breadcrumb-list">
    <li class="breadcrumb-item">
      <a href="/index.html" class="breadcrumb-link">Home</a>
    </li>
    <li class="breadcrumb-separator" aria-hidden="true">/</li>
    <li class="breadcrumb-item">
      <span class="breadcrumb-current" aria-current="page">Current Page</span>
    </li>
  </ol>
</nav>
-->

<!-- Feature Shortcuts (Quick Access Menu) -->
<div class="feature-shortcuts">
  <button class="shortcuts-toggle" type="button" aria-label="Toggle quick access menu" aria-expanded="false" aria-controls="shortcuts-menu">
    <span aria-hidden="true">âš¡</span>
  </button>

  <div class="shortcuts-menu" id="shortcuts-menu" role="menu" aria-label="Quick access menu">
    <div class="shortcuts-header">
      <h3>Quick Access</h3>
    </div>
    <ul class="shortcuts-list">
      <li class="shortcuts-item">
        <a href="/workflow.html" class="shortcuts-link" role="menuitem">
          <span class="shortcuts-icon" aria-hidden="true">âœ¨</span>
          <div class="shortcuts-content">
            <h4 class="shortcuts-title">Resume Workflow</h4>
            <p class="shortcuts-description">Complete guided workflow</p>
          </div>
        </a>
      </li>
      <li class="shortcuts-item">
        <a href="/index.html" class="shortcuts-link" role="menuitem">
          <span class="shortcuts-icon" aria-hidden="true">ğŸ </span>
          <div class="shortcuts-content">
            <h4 class="shortcuts-title">Quick Start</h4>
            <p class="shortcuts-description">Upload and analyze resume</p>
          </div>
        </a>
      </li>
      <li class="shortcuts-item">
        <a href="/builder.html" class="shortcuts-link" role="menuitem">
          <span class="shortcuts-icon" aria-hidden="true">âœï¸</span>
          <div class="shortcuts-content">
            <h4 class="shortcuts-title">Visual Builder</h4>
            <p class="shortcuts-description">Build from scratch</p>
          </div>
        </a>
      </li>
      <li class="shortcuts-item">
        <a href="/analytics-dashboard.html" class="shortcuts-link" role="menuitem">
          <span class="shortcuts-icon" aria-hidden="true">ğŸ“Š</span>
          <div class="shortcuts-content">
            <h4 class="shortcuts-title">Analytics</h4>
            <p class="shortcuts-description">Track your progress</p>
          </div>
        </a>
      </li>
    </ul>
  </div>
</div>

<!-- Navigation JavaScript Module -->
<script type="module" src="/js/navigation/index.js"></script>

<!-- Legacy inline script for backwards compatibility (will be removed once module is confirmed working) -->
<script>
  // Theme Management
  function initTheme() {
    // Check for saved theme preference, system preference, or default to light
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
  }

  function toggleTheme() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  }

  // Initialize theme immediately to prevent flash
  initTheme();

  // Listen for system theme changes
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
    if (!localStorage.getItem('theme')) {
      document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
    }
  });

  // Fallback: Basic mobile navigation toggle
  document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.querySelector('.navbar-toggle');
    const nav = document.querySelector('.navbar-nav');
    const overlay = document.querySelector('.navbar-overlay');
    const closeBtn = document.querySelector('.nav-close-btn');

    if (toggle && nav) {
      toggle.addEventListener('click', function() {
        nav.classList.toggle('mobile-open');
        const isOpen = nav.classList.contains('mobile-open');
        toggle.setAttribute('aria-expanded', isOpen);
        if (overlay) {
          overlay.setAttribute('aria-hidden', !isOpen);
        }
      });

      // Close button
      if (closeBtn) {
        closeBtn.addEventListener('click', function() {
          nav.classList.remove('mobile-open');
          toggle.setAttribute('aria-expanded', 'false');
          if (overlay) {
            overlay.setAttribute('aria-hidden', 'true');
          }
        });
      }

      // Overlay click to close
      if (overlay) {
        overlay.addEventListener('click', function() {
          nav.classList.remove('mobile-open');
          toggle.setAttribute('aria-expanded', 'false');
          overlay.setAttribute('aria-hidden', 'true');
        });
      }
    }

    // Feature shortcuts toggle
    const shortcutsToggle = document.querySelector('.shortcuts-toggle');
    const shortcutsMenu = document.querySelector('.shortcuts-menu');

    if (shortcutsToggle && shortcutsMenu) {
      shortcutsToggle.addEventListener('click', function() {
        shortcutsMenu.classList.toggle('active');
        const isActive = shortcutsMenu.classList.contains('active');
        shortcutsToggle.setAttribute('aria-expanded', isActive);
      });

      // Close on click outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.feature-shortcuts')) {
          shortcutsMenu.classList.remove('active');
          shortcutsToggle.setAttribute('aria-expanded', 'false');
        }
      });
    }

    // Highlight active page with aria-current support
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    document.querySelectorAll('.nav-link, .nav-dropdown-link').forEach(link => {
      const href = link.getAttribute('href');
      if (href === `/${currentPage}` || href === currentPage || href === window.location.pathname) {
        link.classList.add('active');
        // Add aria-current for accessibility
        link.setAttribute('aria-current', 'page');

        // Also mark parent dropdown as active
        const dropdown = link.closest('.nav-dropdown');
        if (dropdown) {
          const dropdownToggle = dropdown.querySelector('.nav-dropdown-toggle');
          if (dropdownToggle) {
            dropdownToggle.classList.add('active');
          }
        }
      }
    });
  });
</script>
